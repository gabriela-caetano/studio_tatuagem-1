<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="studio_tatuagem.sqlite" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="3682"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="agendamentos" custom_title="0" dock_id="2" table="4,12:mainagendamentos"/><dock_state state="000000ff00000000fd00000001000000020000000000000000fc0100000002fb000000160064006f0063006b00420072006f00770073006500310100000000ffffffff0000000000000000fb000000160064006f0063006b00420072006f00770073006500320100000000ffffffff0000012400ffffff000000000000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings/></tab_browse><tab_sql><sql name="SQL 1*">-- SQLite Schema para Sistema de Gestão de Studio de Tatuagem

-- Tabela de clientes
CREATE TABLE clientes (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    email TEXT NOT NULL UNIQUE,
    telefone TEXT NOT NULL,
    cpf TEXT NOT NULL UNIQUE,
    data_nascimento TEXT,
    endereco TEXT,
    cidade TEXT,
    estado TEXT,
    cep TEXT,
    observacoes TEXT,
    data_cadastro TEXT DEFAULT (datetime('now')),
    ativo INTEGER DEFAULT 1
);
CREATE INDEX idx_clientes_email ON clientes(email);
CREATE INDEX idx_clientes_cpf ON clientes(cpf);
CREATE INDEX idx_clientes_nome ON clientes(nome);

-- Tabela de tatuadores
CREATE TABLE tatuadores (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    email TEXT NOT NULL UNIQUE,
    telefone TEXT NOT NULL,
    especialidades TEXT,
    biografia TEXT,
    portfolio_url TEXT,
    instagram TEXT,
    valor_hora REAL,
    disponibilidade TEXT,
    data_cadastro TEXT DEFAULT (datetime('now')),
    ativo INTEGER DEFAULT 1
);
CREATE INDEX idx_tatuadores_email ON tatuadores(email);
CREATE INDEX idx_tatuadores_nome ON tatuadores(nome);

-- Tabela de serviços
CREATE TABLE servicos (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    descricao TEXT,
    preco_base REAL NOT NULL,
    duracao_estimada INTEGER NOT NULL,
    categoria TEXT DEFAULT 'tatuagem_pequena',
    ativo INTEGER DEFAULT 1,
    data_cadastro TEXT DEFAULT (datetime('now'))
);
CREATE INDEX idx_servicos_categoria ON servicos(categoria);
CREATE INDEX idx_servicos_nome ON servicos(nome);

-- Tabela de agendamentos
CREATE TABLE agendamentos (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    cliente_id INTEGER NOT NULL,
    tatuador_id INTEGER NOT NULL,
    servico_id INTEGER,
    data_agendamento TEXT NOT NULL,
    hora_inicio TEXT NOT NULL,
    hora_fim TEXT,
    descricao_tatuagem TEXT NOT NULL,
    valor_estimado REAL,
    valor_final REAL,
    status TEXT DEFAULT 'agendado',
    observacoes TEXT,
    data_cadastro TEXT DEFAULT (datetime('now')),
    data_atualizacao TEXT DEFAULT (datetime('now')),
    FOREIGN KEY (cliente_id) REFERENCES clientes(id),
    FOREIGN KEY (tatuador_id) REFERENCES tatuadores(id),
    FOREIGN KEY (servico_id) REFERENCES servicos(id)
);
CREATE INDEX idx_agendamentos_cliente ON agendamentos(cliente_id);
CREATE INDEX idx_agendamentos_tatuador ON agendamentos(tatuador_id);
CREATE INDEX idx_agendamentos_data ON agendamentos(data_agendamento);
CREATE INDEX idx_agendamentos_status ON agendamentos(status);

-- Tabela de usuários do sistema
CREATE TABLE usuarios (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    email TEXT NOT NULL UNIQUE,
    senha TEXT NOT NULL,
    tipo TEXT DEFAULT 'atendente',
    tatuador_id INTEGER,
    ativo INTEGER DEFAULT 1,
    data_cadastro TEXT DEFAULT (datetime('now')),
    ultimo_login TEXT,
    FOREIGN KEY (tatuador_id) REFERENCES tatuadores(id)
);
CREATE INDEX idx_usuarios_email ON usuarios(email);

-- Tabela de histórico de agendamentos
CREATE TABLE historico_agendamentos (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    agendamento_id INTEGER NOT NULL,
    status_anterior TEXT,
    status_novo TEXT,
    usuario_id INTEGER,
    observacoes TEXT,
    data_alteracao TEXT DEFAULT (datetime('now')),
    FOREIGN KEY (agendamento_id) REFERENCES agendamentos(id),
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id)
);
CREATE INDEX idx_historico_agendamento ON historico_agendamentos(agendamento_id);

-- Tabela de fotos de trabalhos (portfolio)
CREATE TABLE portfolio_fotos (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    tatuador_id INTEGER NOT NULL,
    agendamento_id INTEGER,
    nome_arquivo TEXT NOT NULL,
    caminho_arquivo TEXT NOT NULL,
    descricao TEXT,
    tags TEXT,
    data_upload TEXT DEFAULT (datetime('now')),
    ativo INTEGER DEFAULT 1,
    FOREIGN KEY (tatuador_id) REFERENCES tatuadores(id),
    FOREIGN KEY (agendamento_id) REFERENCES agendamentos(id)
);
CREATE INDEX idx_portfolio_tatuador ON portfolio_fotos(tatuador_id);

-- Dados iniciais
INSERT INTO servicos (nome, descricao, preco_base, duracao_estimada, categoria) VALUES
('Tatuagem Pequena', 'Tatuagem até 5cm', 150.00, 60, 'tatuagem_pequena'),
('Tatuagem Média', 'Tatuagem entre 5cm e 15cm', 300.00, 120, 'tatuagem_media'),
('Tatuagem Grande', 'Tatuagem maior que 15cm', 500.00, 240, 'tatuagem_grande'),
('Retoque', 'Retoque em tatuagem existente', 100.00, 45, 'retoque'),
('Cover Up', 'Cobertura de tatuagem antiga', 400.00, 180, 'cover_up'),
('Piercing', 'Colocação de piercing', 80.00, 30, 'piercing'),
('Consulta', 'Consulta e orçamento', 50.00, 30, 'consulta');

INSERT INTO tatuadores (nome, email, telefone, especialidades, biografia, valor_hora) VALUES
('Carlos Silva', 'carlos@studio.com', '(11) 99999-1111', 'Realismo, Blackwork', 'Tatuador com 10 anos de experiência em realismo e blackwork.', 120.00),
('Ana Santos', 'ana@studio.com', '(11) 99999-2222', 'Fine Line, Aquarela', 'Especialista em traços finos e técnicas de aquarela.', 100.00),
('Roberto Costa', 'roberto@studio.com', '(11) 99999-3333', 'Old School, New School', 'Mestre em estilos clássicos e modernos de tatuagem.', 110.00);

INSERT INTO usuarios (nome, email, senha, tipo) VALUES
('Administrador', 'admin@studio.com', '$2a$10$rOYDOqhM7gAI5zw.B5JqOeOEdrFTJq5gkT9yoO5OqO5OqO5OqO5OqO', 'admin');
</sql><current_tab id="0"/></tab_sql></sqlb_project>
